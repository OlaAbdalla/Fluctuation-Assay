
﻿
**Title**

R-codes for Calculating Fluctuation Assay Results and 95% Confidence Intervals Based on Ma-Sandri-Sarkar Maximum Likelihood.

**Abstract**

The Luria-Delbrück fluctuation assay is an essential experiment in calculating mutation rates, especially in genetic and mutation research. Its reliability and accuracy have made it the go-to method for numerous researchers. In this article, we provide R-codes that statistically analyze the assay results more easily and offer the most challenging codes for calculating 95% confidence intervals based on the gold standard method “Ma-Sandri-Sarkar Maximum Likelihood.” Recently, the maximization of the likelihood function through optimization functions in R can be a challenging task. The recursive format of the likelihood function is known to cause memory stack issues. However, a non-recursive version of the function can be used to increase the tractability of the maximization process. With these codes, future scientists can unlock valuable statistical insights related to the biological mechanisms that drive genetic variation and can, therefore, contribute to developing novel therapeutic interventions and innovative solutions to various biological and medical challenges.



R software can be utilized to compute the parameter (m) precisely using the Ma-Sandri-Sarkar maximum likelihood method. To avoid problematic stack growth, we implemented a non-recursive version of the likelihood function and used non-parametric bootstrapping to quantify parameter uncertainty. These techniques allow us to achieve the best results possible when using the MSS Maximum Likelihood approach and fill a gap in the literature, as this is the only non-recursive version of the likelihood that appears to be available.

This approach involved leveraging a unique experimental (r) value vector and a count vector for each (r) value to determine how many cultures (C) returned each distinct (r) value. A powerful non-recursive function for Pr(m) and a negative log-likelihood function was employed and written in terms of m, the two datasets, and the Pr(m) function. By minimizing this function via R's optimization, 95% confidence intervals (95% CL)  were calculated using equations 29 and 30 [[1](#biblioref00)]. 

Moreover, a non-parametric bootstrapping technique was employed to estimate confidence intervals. By resampling the experimental values (1000 times) and calculating m using the MSS Maximum Likelihood approach for each bootstrap replicate, confidence intervals were generated by extracting the 2.5th and 97.5th percentiles from the 1000 bootstrap replicates. 

- This code includes two functions, conditionalProb\_r() and loglik():conditionalProb\_r() takes as input *r* and *m*, and returns as output the probability of obtaining *r* mutations in a culture with the expected number of mutations *m*, assuming the Luria-Delbruck distribution;
- loglik()takes as input: the expected number of mutations per culture *m*, a vector of unique experimental mutations *rVec*, and the corresponding vector of counts for each unique experimental r *rCard* and returns as output the log-likelihood assuming the Luria-Delbruck distribution.



**References** 

- [1] P.L. Foster, Methods for Determining Spontaneous Mutation Rates, Methods Enzym. 409 (2006) 195–213. <https://doi.org/10.1016/s0076-6879(05)09012-9>. 
- [2] W.A. Rosche, P.L. Foster, Determining Mutation Rates in Bacterial Populations, Methods. 20 (2000) 4–17. https://doi.org/10.1006/meth.1999.0901.
